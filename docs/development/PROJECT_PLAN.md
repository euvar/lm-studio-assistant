# LM Studio Assistant - План проекта

## Обзор проекта
Создание CLI-приложения, аналогичного Claude Code, но с использованием локальных моделей через LM Studio.

## Основные функции
- Интеграция с LM Studio API для выбора и использования различных моделей
- Файловые операции (чтение, запись, редактирование)
- Поиск в интернете
- Интерактивный CLI интерфейс
- Выполнение команд в терминале
- Автоматическая проверка созданного кода

## Технологический стек
- **Язык**: TypeScript/Node.js
- **CLI Framework**: Ink (React для терминала) или Commander.js + Inquirer
- **HTTP клиент**: Axios для работы с LM Studio API
- **Файловые операции**: Node.js fs/promises
- **Web поиск**: Puppeteer или API поисковиков
- **Подсветка синтаксиса**: Chalk, syntax-highlight

## Структура проекта
```
lm-studio-assistant/
├── src/
│   ├── index.ts              # Точка входа
│   ├── cli/                  # CLI интерфейс
│   │   ├── app.tsx          # Основной UI компонент (если Ink)
│   │   └── commands.ts      # CLI команды
│   ├── core/                # Ядро приложения
│   │   ├── agent.ts         # Основной агент
│   │   ├── context.ts       # Управление контекстом
│   │   └── prompts.ts       # Системные промпты
│   ├── providers/           # Интеграции с LM Studio
│   │   ├── lmstudio.ts      # Клиент для LM Studio API
│   │   └── models.ts        # Управление моделями
│   ├── tools/               # Инструменты для моделей
│   │   ├── filesystem.ts    # Файловые операции
│   │   ├── websearch.ts     # Поиск в интернете
│   │   ├── bash.ts          # Выполнение команд
│   │   └── index.ts         # Регистрация инструментов
│   └── utils/               # Вспомогательные функции
├── docs/                    # Документация
├── examples/               # Примеры использования
├── tests/                  # Тесты
└── package.json
```

## Этапы разработки

### Фаза 1: Базовая инфраструктура
1. Настройка проекта (TypeScript, ESLint, тесты)
2. Создание базового CLI интерфейса
3. Интеграция с LM Studio API
4. Базовая система промптов

### Фаза 2: Система инструментов
1. Реализация файловых операций (read, write, edit)
2. Интеграция поиска в интернете
3. Выполнение bash команд
4. Система регистрации и вызова инструментов

### Фаза 3: Управление контекстом
1. Оптимизация промптов для локальных моделей
2. Управление историей диалога
3. Сжатие контекста при необходимости

### Фаза 4: Продвинутые функции
1. Мультифайловое редактирование
2. Проектный контекст (анализ структуры проекта)
3. Автоматическое тестирование созданного кода
4. Интеграция с git

### Фаза 5: UI и UX
1. Красивый интерактивный интерфейс
2. Подсветка синтаксиса кода
3. Прогресс-бары для долгих операций
4. История команд

## Ключевые решения

### Работа с LM Studio API
```typescript
// Пример конфигурации
const config = {
  baseURL: 'http://localhost:1234/v1',
  model: 'selected-model-name',
  temperature: 0.7,
  max_tokens: 4000
}
```

### Function Calling
Нужно реализовать собственную систему function calling, так как не все модели поддерживают это нативно:
- Структурированные промпты с XML/JSON для описания инструментов
- Парсинг ответов модели для извлечения вызовов функций
- Fallback на текстовые команды для простых моделей

### Обработка ошибок
- Graceful degradation при недоступности модели
- Повторные попытки при сетевых ошибках
- Валидация инструментов перед выполнением

## Примеры использования

```bash
# Запуск приложения
lm-assistant

# Выбор модели
lm-assistant --model "llama-3.1-8b"

# Создание проекта
> Создай простой веб-сайт с главной страницей

# Поиск и исправление ошибок
> Найди в интернете как исправить ошибку "Cannot find module 'express'"
```